$.loadScript = function( src, cbk){
    var script = document.createElement("script");
    script.src = src;
    script.onload = cbk;
    $(script).appendTo("body");
};

$(function(){document.createElement("canvas").getContext?$.loadScript("js/cav.min.js",function(){function e(){t(),i(),a(),o(),m(),r(S.offsetWidth,S.offsetHeight),c()}function t(){v=new CAV.CanvasRenderer,n(M.renderer)}function n(e){switch(g&&H.removeChild(g.element),e){case w:g=v}g.setSize(S.offsetWidth,S.offsetHeight),H.appendChild(g.element)}function i(){u=new CAV.Scene}function a(){u.remove(C),g.clear(),A=new CAV.Plane(y.width*g.width,y.height*g.height,y.segments,y.slices),p=new CAV.Material(y.ambient,y.diffuse),C=new CAV.Mesh(A,p),u.add(C);var e,t;for(e=A.vertices.length-1;e>=0;e--)t=A.vertices[e],t.anchor=CAV.Vector3.clone(t.position),t.step=CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),t.time=Math.randomInRange(0,Math.PIM2)}function o(){var e,t;for(e=u.lights.length-1;e>=0;e--)t=u.lights[e],u.remove(t);for(g.clear(),e=0;e<b.count;e++)t=new CAV.Light(b.ambient,b.diffuse),t.ambientHex=t.ambient.format(),t.diffuseHex=t.diffuse.format(),u.add(t),t.mass=Math.randomInRange(.5,1),t.velocity=CAV.Vector3.create(),t.acceleration=CAV.Vector3.create(),t.force=CAV.Vector3.create()}function r(e,t){g.setSize(e,t),CAV.Vector3.set(x,g.halfWidth,g.halfHeight),a()}function c(){V=Date.now()-R,s(),f(),requestAnimationFrame(c)}function s(){var e,t,n,i,a,o,r,c=y.depth/2;for(CAV.Vector3.copy(b.bounds,x),CAV.Vector3.multiplyScalar(b.bounds,b.xyScalar),CAV.Vector3.setZ(I,b.zOffset),i=u.lights.length-1;i>=0;i--){a=u.lights[i],CAV.Vector3.setZ(a.position,b.zOffset);var s=Math.clamp(CAV.Vector3.distanceSquared(a.position,I),b.minDistance,b.maxDistance),f=b.gravity*a.mass/s;CAV.Vector3.subtractVectors(a.force,I,a.position),CAV.Vector3.normalise(a.force),CAV.Vector3.multiplyScalar(a.force,f),CAV.Vector3.set(a.acceleration),CAV.Vector3.add(a.acceleration,a.force),CAV.Vector3.add(a.velocity,a.acceleration),CAV.Vector3.multiplyScalar(a.velocity,b.dampening),CAV.Vector3.limit(a.velocity,b.minLimit,b.maxLimit),CAV.Vector3.add(a.position,a.velocity)}for(o=A.vertices.length-1;o>=0;o--)r=A.vertices[o],e=Math.sin(r.time+r.step[0]*V*y.speed),t=Math.cos(r.time+r.step[1]*V*y.speed),n=Math.sin(r.time+r.step[2]*V*y.speed),CAV.Vector3.set(r.position,y.xRange*A.segmentWidth*e,y.yRange*A.sliceHeight*t,y.zRange*c*n-c),CAV.Vector3.add(r.position,r.anchor);A.dirty=!0}function f(){g.render(u)}function d(e){var t,n,i=e,a=function(e){for(t=0,l=u.lights.length;t<l;t++)n=u.lights[t],n.ambient.set(e),n.ambientHex=n.ambient.format()},o=function(e){for(t=0,l=u.lights.length;t<l;t++)n=u.lights[t],n.diffuse.set(e),n.diffuseHex=n.diffuse.format()};return{set:function(){a(i[0]),o(i[1])}}}function m(){window.addEventListener("resize",h)}function h(){r(S.offsetWidth,S.offsetHeight),f()}var V,g,u,C,A,p,v,y={width:1.5,height:1.5,depth:10,segments:12,slices:6,xRange:.8,yRange:.1,zRange:1,ambient:"#525252",diffuse:"#FFFFFF",speed:2e-4},b={count:2,xyScalar:1,zOffset:100,ambient:"#002c4a",diffuse:"#005584",speed:.001,gravity:1200,dampening:.95,minLimit:10,maxLimit:null,minDistance:20,maxDistance:400,autopilot:!1,draw:!1,bounds:CAV.Vector3.create(),step:CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1))},w="canvas",M={renderer:w},R=Date.now(),x=CAV.Vector3.create(),I=CAV.Vector3.create(),S=document.getElementById("container"),H=document.getElementById("anitOut");e(),$("#fshow").bannerShow({changeColor:d})}):$(".banner").css({backgroundImage:"url(images/banner.gif)"})});
